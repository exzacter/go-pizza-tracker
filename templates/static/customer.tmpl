{{template "top" .}}
<title>{{.Title}}</title>
</head>
<body class="bg-gradient-to-br from-amber-50 via-orange-50 to-rose-50 min-h-screen">
<div class="flex items-center justify-center p-6 md:p-8">
	<div class="bg-white/80 backdrop-blur-sm p-8 md:p-10 rounded-3xl shadow-xl border border-white/20 max-w-3xl w-full">
		
		<!-- Header -->
		<div class="text-center mb-8">
			<h1 class="text-4xl font-bold text-gray-900 tracking-tight">Track Your Pizza Order</h1>
			<p class="text-gray-500 mt-2">Order #{{.Order.ID}}</p>
		</div>

<!-- Progress Tracker -->
<div class="mb-10">
	<div class="flex justify-between items-center relative">
		<!-- Progress Line Background -->
		<div class="absolute top-5 left-0 right-0 h-1 bg-gray-200"></div>
		
		<!-- Progress Line Active -->
		<div id="progressBar" class="absolute top-5 left-0 h-1 bg-emerald-500 transition-all duration-1000 ease-out" style="width: 0%"></div>

		{{range $index, $status := .Statuses}}
		<div class="flex flex-col items-center z-10">
			<!-- Circle -->
			<div class="status-circle w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold bg-gray-200 text-gray-500 transition-all duration-500"
				data-status="{{$status}}"
				data-index="{{$index}}">
				{{if eq $status "Order Placed"}}üìã
				{{else if eq $status "Preparing"}}üë®‚Äçüç≥
				{{else if eq $status "Cooking"}}üî•
				{{else if eq $status "Quality Check"}}‚úÖ
				{{else if eq $status "Ready"}}üçï
				{{end}}
			</div>
			<!-- Label -->
			<span class="status-label mt-2 text-xs font-medium text-center text-gray-500 transition-all duration-500" data-status="{{$status}}">
				{{$status}}
			</span>
		</div>
		{{end}}
	</div>
</div>

		<!-- Current Status Banner -->
		<div class="bg-emerald-50 border border-emerald-200 rounded-xl p-4 mb-8 text-center">
			<p class="text-emerald-700 font-medium">
				{{if eq .Order.Status "Order Placed"}}We've received your order and will start preparing it soon!
				{{else if eq .Order.Status "Preparing"}}Our chefs are preparing your ingredients!
				{{else if eq .Order.Status "Cooking"}}Your pizza is in the oven!
				{{else if eq .Order.Status "Quality Check"}}Almost there! We're making sure everything is perfect.
				{{else if eq .Order.Status "Ready"}}Your pizza is ready for pickup/delivery!
				{{end}}
			</p>
		</div>

		<!-- Order Details -->
		<div class="grid md:grid-cols-2 gap-6 mb-8">
			<div class="bg-gray-50 rounded-xl p-5">
				<h2 class="text-lg font-semibold text-gray-800 mb-4">Customer Details</h2>
				<div class="space-y-3">
					<div>
						<span class="text-gray-500 text-sm">Name</span>
						<p class="text-gray-800 font-medium">{{.Order.CustomerName}}</p>
					</div>
					<div>
						<span class="text-gray-500 text-sm">Phone</span>
						<p class="text-gray-800 font-medium">{{.Order.Phone}}</p>
					</div>
					<div>
						<span class="text-gray-500 text-sm">Address</span>
						<p class="text-gray-800 font-medium">{{.Order.Address}}</p>
					</div>
				</div>
			</div>

			<div class="bg-gray-50 rounded-xl p-5">
				<h2 class="text-lg font-semibold text-gray-800 mb-4">Order Info</h2>
				<div class="space-y-3">
					<div>
						<span class="text-gray-500 text-sm">Order Number</span>
						<p class="text-gray-800 font-medium font-mono">{{.Order.ID}}</p>
					</div>
					<div>
						<span class="text-gray-500 text-sm">Order Time</span>
						<p class="text-gray-800 font-medium">{{.Order.CreatedAt.Format "Mon, 02 Jan 2006 3:04 PM"}}</p>
					</div>
					<div>
						<span class="text-gray-500 text-sm">Total Pizzas</span>
						<p class="text-gray-800 font-medium">{{len .Order.Items}} pizza{{if gt (len .Order.Items) 1}}s{{end}}</p>
					</div>
				</div>
			</div>
		</div>

		<!-- Pizzas Ordered -->
		<div class="mb-6">
			<h2 class="text-lg font-semibold text-gray-800 mb-4">Your Pizzas</h2>
			<div class="space-y-4">
				{{range $index, $item := .Order.Items}}
				<div class="bg-gray-50 rounded-xl p-5">
					<div class="flex justify-between items-start mb-3">
						<div>
							<h3 class="font-semibold text-gray-800">{{$item.Pizza}}</h3>
							<p class="text-gray-500 text-sm">{{$item.Size}} ‚Ä¢ {{$item.Crust}} Crust</p>
						</div>
						<span class="bg-emerald-100 text-emerald-700 text-xs font-medium px-2 py-1 rounded-full">
							Pizza #{{add $index 1}}
						</span>
					</div>
					
					{{if $item.Toppings}}
					<div class="mb-3">
						<span class="text-gray-500 text-sm">Toppings:</span>
						<div class="flex flex-wrap gap-2 mt-1">
							{{range $item.Toppings}}
							<span class="inline-flex items-center px-2 py-1 text-xs rounded-full
								{{if .IsExtra}}bg-amber-100 text-amber-700{{else}}bg-gray-200 text-gray-600{{end}}
							">
								{{.Topping}}{{if .IsExtra}} (extra){{end}}
							</span>
							{{end}}
						</div>
					</div>
					{{end}}

					{{if $item.Instructions}}
					<div class="mt-3 pt-3 border-t border-gray-200">
						<span class="text-gray-500 text-sm">Special Instructions:</span>
						<p class="text-gray-700 text-sm mt-1">{{$item.Instructions}}</p>
					</div>
					{{end}}
				</div>
				{{end}}
			</div>
		</div>

		<!-- Dietary & Allergies (if any) -->
		{{$firstItem := index .Order.Items 0}}
		{{if or $firstItem.DietaryRequirement $firstItem.Allergies}}
		<div class="bg-amber-50 border border-amber-200 rounded-xl p-5">
			<h2 class="text-lg font-semibold text-amber-800 mb-3">Dietary Notes</h2>
			<div class="flex flex-wrap gap-4">
				{{if $firstItem.DietaryRequirement}}
				<div>
					<span class="text-amber-700 text-sm font-medium">Dietary Requirements:</span>
					<div class="flex flex-wrap gap-1 mt-1">
						{{range $firstItem.DietaryRequirement}}
						<span class="bg-amber-100 text-amber-700 text-xs px-2 py-1 rounded-full">{{.DietaryRequirement}}</span>
						{{end}}
					</div>
				</div>
				{{end}}
				{{if $firstItem.Allergies}}
				<div>
					<span class="text-red-700 text-sm font-medium">Allergies:</span>
					<div class="flex flex-wrap gap-1 mt-1">
						{{range $firstItem.Allergies}}
						<span class="bg-red-100 text-red-700 text-xs px-2 py-1 rounded-full">{{.Allergy}}</span>
						{{end}}
					</div>
				</div>
				{{end}}
			</div>
		</div>
		{{end}}

		<!-- Back Button -->
		<div class="mt-8 text-center">
			<a href="/" class="text-emerald-600 hover:text-emerald-700 font-medium transition-colors">
				‚Üê Place Another Order
			</a>
		</div>

	</div>
</div>
<script>
	const currentStatus = "{{.Order.Status}}";
	const statuses = [
		{{range $index, $status := .Statuses}}
		"{{$status}}"{{if lt $index 4}},{{end}}
		{{end}}
	];
	
	function updateProgress() {
		const currentIndex = statuses.indexOf(currentStatus);
		const progressBar = document.getElementById('progressBar');
		const circles = document.querySelectorAll('.status-circle');
		const labels = document.querySelectorAll('.status-label');
		
		// Calculate progress percentage (0%, 25%, 50%, 75%, 100%)
		const progressPercent = (currentIndex / (statuses.length - 1)) * 100;
		
		// Animate progress bar after a short delay
		setTimeout(() => {
			progressBar.style.width = progressPercent + '%';
		}, 100);
		
		// Update circles and labels
		circles.forEach((circle, index) => {
			setTimeout(() => {
				if (index < currentIndex) {
					// Completed
					circle.classList.remove('bg-gray-200', 'text-gray-500');
					circle.classList.add('bg-emerald-500', 'text-white');
				} else if (index === currentIndex) {
					// Current
					circle.classList.remove('bg-gray-200', 'text-gray-500');
					circle.classList.add('bg-emerald-500', 'text-white', 'ring-4', 'ring-emerald-200');
				}
			}, 100 + (index * 200)); // Stagger the animations
		});
		
		labels.forEach((label, index) => {
			setTimeout(() => {
				if (index <= currentIndex) {
					label.classList.remove('text-gray-500');
					label.classList.add('text-emerald-600');
				}
			}, 100 + (index * 200));
		});
	}
	
	// Run on page load
	document.addEventListener('DOMContentLoaded', updateProgress);
</script>{{template "bottom"}}
